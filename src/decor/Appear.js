import { observeAttributeBySelector } from "../mixin/Observer";
import { animateShow, animateHide } from "./Animation";
//
export const initVisibility = async (ROOT = document.body) => {
    observeAttributeBySelector(ROOT, "*", "data-hidden", (mutation, observer) => {
        if (mutation.attributeName == 'data-hidden') {
            const target = mutation.target;
            // TODO? legacy "false" support
            if (target.getAttribute("data-hidden") !== mutation.oldValue) {
                // @ts-ignore
                Promise?.try?.(target.getAttribute("data-hidden") != null ? animateHide : animateShow, target, observer)?.catch?.(console.warn.bind(console));
            }
        }
    });
};
//
export default initVisibility;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXBwZWFyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQXBwZWFyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQy9ELE9BQU8sRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRXZELEVBQUU7QUFDRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsS0FBSyxFQUFFLE9BQVksUUFBUSxDQUFDLElBQUksRUFBQyxFQUFFO0lBQzdELDBCQUEwQixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsYUFBYSxFQUFFLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBQyxFQUFFO1FBQ3ZFLElBQUksUUFBUSxDQUFDLGFBQWEsSUFBSSxhQUFhLEVBQUUsQ0FBQztZQUMxQyxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsTUFBcUIsQ0FBQztZQUU5QywrQkFBK0I7WUFDL0IsSUFBSSxNQUFNLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztnQkFDM0QsYUFBYTtnQkFDYixPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ2xKLENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUE7QUFFRCxFQUFFO0FBQ0YsZUFBZSxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvYnNlcnZlQXR0cmlidXRlQnlTZWxlY3RvciB9IGZyb20gXCIuLi9taXhpbi9PYnNlcnZlclwiO1xuaW1wb3J0IHsgYW5pbWF0ZVNob3csIGFuaW1hdGVIaWRlIH0gZnJvbSBcIi4vQW5pbWF0aW9uXCI7XG5cbi8vXG5leHBvcnQgY29uc3QgaW5pdFZpc2liaWxpdHkgPSBhc3luYyAoUk9PVDogYW55ID0gZG9jdW1lbnQuYm9keSk9PntcbiAgICBvYnNlcnZlQXR0cmlidXRlQnlTZWxlY3RvcihST09ULCBcIipcIiwgXCJkYXRhLWhpZGRlblwiLCAobXV0YXRpb24sIG9ic2VydmVyKT0+e1xuICAgICAgICBpZiAobXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PSAnZGF0YS1oaWRkZW4nKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBtdXRhdGlvbi50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAgICAgICAgIC8vIFRPRE8/IGxlZ2FjeSBcImZhbHNlXCIgc3VwcG9ydFxuICAgICAgICAgICAgaWYgKHRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWhpZGRlblwiKSAhPT0gbXV0YXRpb24ub2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgUHJvbWlzZT8udHJ5Py4odGFyZ2V0LmdldEF0dHJpYnV0ZShcImRhdGEtaGlkZGVuXCIpICE9IG51bGwgPyBhbmltYXRlSGlkZSA6IGFuaW1hdGVTaG93LCB0YXJnZXQsIG9ic2VydmVyKT8uY2F0Y2g/Lihjb25zb2xlLndhcm4uYmluZChjb25zb2xlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuLy9cbmV4cG9ydCBkZWZhdWx0IGluaXRWaXNpYmlsaXR5O1xuIl19