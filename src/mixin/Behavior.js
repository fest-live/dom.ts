export const boundBehaviors = new WeakMap();
// currently, behaviors not triggers when initialized
export const bindBehavior = (element, behSet, behavior) => {
    const weak = new WeakRef(element);
    if (!behSet.has(behavior)) {
        behSet.add(behavior);
    }
    return element;
};
// behavior ([value, prop, old], [element, store, storeSets])=>{}
export const reflectBehaviors = (element, behaviors) => {
    if (!element)
        return;
    if (behaviors) {
        // !experimental `getOrInsert` feature!
        // @ts-ignore
        const behSet = boundBehaviors.getOrInsert(element, new Set());
        [...(behaviors?.values?.() || [])].map((e) => bindBehavior(element, behSet, e));
    }
    return element;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQmVoYXZpb3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJCZWhhdmlvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztBQUU1QyxxREFBcUQ7QUFDckQsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUMsRUFBRTtJQUNyRCxNQUFNLElBQUksR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNsQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1FBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUFDLENBQUM7SUFDcEQsT0FBTyxPQUFPLENBQUM7QUFDbkIsQ0FBQyxDQUFBO0FBRUQsaUVBQWlFO0FBQ2pFLE1BQU0sQ0FBQyxNQUFNLGdCQUFnQixHQUFHLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBQyxFQUFFO0lBQ2xELElBQUksQ0FBQyxPQUFPO1FBQUUsT0FBTztJQUNyQixJQUFJLFNBQVMsRUFBRSxDQUFDO1FBQ1osdUNBQXVDO1FBQ3ZDLGFBQWE7UUFDYixNQUFNLE1BQU0sR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxJQUFJLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsRUFBRSxDQUFBLFlBQVksQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbEYsQ0FBQztJQUNELE9BQU8sT0FBTyxDQUFDO0FBQ25CLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBib3VuZEJlaGF2aW9ycyA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIGN1cnJlbnRseSwgYmVoYXZpb3JzIG5vdCB0cmlnZ2VycyB3aGVuIGluaXRpYWxpemVkXG5leHBvcnQgY29uc3QgYmluZEJlaGF2aW9yID0gKGVsZW1lbnQsIGJlaFNldCwgYmVoYXZpb3IpPT57XG4gICAgY29uc3Qgd2VhayA9IG5ldyBXZWFrUmVmKGVsZW1lbnQpO1xuICAgIGlmICghYmVoU2V0LmhhcyhiZWhhdmlvcikpIHsgYmVoU2V0LmFkZChiZWhhdmlvcik7IH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn1cblxuLy8gYmVoYXZpb3IgKFt2YWx1ZSwgcHJvcCwgb2xkXSwgW2VsZW1lbnQsIHN0b3JlLCBzdG9yZVNldHNdKT0+e31cbmV4cG9ydCBjb25zdCByZWZsZWN0QmVoYXZpb3JzID0gKGVsZW1lbnQsIGJlaGF2aW9ycyk9PntcbiAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcbiAgICBpZiAoYmVoYXZpb3JzKSB7XG4gICAgICAgIC8vICFleHBlcmltZW50YWwgYGdldE9ySW5zZXJ0YCBmZWF0dXJlIVxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGJlaFNldCA9IGJvdW5kQmVoYXZpb3JzLmdldE9ySW5zZXJ0KGVsZW1lbnQsIG5ldyBTZXQoKSk7XG4gICAgICAgIFsuLi4oYmVoYXZpb3JzPy52YWx1ZXM/LigpIHx8IFtdKV0ubWFwKChlKT0+YmluZEJlaGF2aW9yKGVsZW1lbnQsIGJlaFNldCwgZSkpO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn1cbiJdfQ==